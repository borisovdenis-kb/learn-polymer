<link rel="import" href="../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">

<dom-module id="paper-button-with-loading">
  <template>
    <style>
      :host {
        display: block;
      }

      .svg-loading {
        height: 15px;
        position: absolute;
        text-align: center;
        opacity: 0;
        fill: var(--paper-button-with-loading-circles-color);
      }
    </style>

    <paper-button id="btn" on-tap="addLoadingSvg" raised disabled="{{buttonIsDisabled}}">
      <!--<img class="svg-loading" id="svgLoading" src="/static/loading-bar.svg"/>-->
      <svg id="svgLoading" width="120" height="30" class="svg-loading" viewBox="0 0 120 30" xmlns="http://www.w3.org/2000/svg">
        <g id="loader-for-buttons">
          <circle cx="15" cy="15" r="3">
            <animate id="ani_circle_1"
                     attributeName="r"
                     begin="0;ani_circle_1.end+0.6s"
                     dur="0.9s"
                     values="3; 15; 3"
                     calcMode="ease-in-out"
            />
          </circle>
          <circle cx="60" cy="15" r="3">
            <animate id="ani_circle_2"
                     attributeName="r"
                     begin="0.225s;ani_circle_2.end+0.6s"
                     dur="0.9s"
                     values="3; 15; 3"
                     calcMode="ease-in-out" />
          </circle>
          <circle cx="105" cy="15" r="3">
            <animate id="ani_circle_3"
                     attributeName="r"
                     begin="0.45s;ani_circle_3.end+0.6s"
                     dur="0.9s"
                     values="3; 15; 3"
                     calcMode="ease-in-out" />
          </circle>
        </g>
      </svg>
      {{text}}
    </paper-button>

  </template>

  <script>
    /**
     * @customElement
     * @polymer
     */
    class PaperButtonWithLoading extends Polymer.Element {
      static get is() { return 'paper-button-with-loading'; }
      static get properties() {
        return {
          text: {
            type: String
          },
          buttonIsDisabled: {
            type: Boolean,
            value: false
          },
          loadingIsVisible: {
            type: Boolean,
            value: false
          },
          loadingCirclesColor: {
            type: String,
            value: "#ff3784"
          }
        };
      }

      addLoadingSvg() {
        this.$.btn.style.color = '#EAEAEA';
        this.$.svgLoading.style.opacity = '1';
        this.buttonIsDisabled = true;
        this.loadingIsVisible = true;
      }

    }

    window.customElements.define(PaperButtonWithLoading.is, PaperButtonWithLoading);
  </script>
</dom-module>
